<!DOCTYPE html> <!-- Type on Strap jekyll theme v2.0.0 Copyright 2016-2019 Sylhare Theme free for personal and commercial use under the MIT license https://github.com/sylhare/Type-on-Strap/blob/master/LICENSE --> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"> <!-- CSS --> <link rel="stylesheet" href="/assets/css/main.css"> <!--Favicon--> <link rel="shortcut icon" href="/assets/favicon.png" type="image/x-icon"> <!-- Canonical --> <link rel="canonical" href="https://sarthakmakhija.github.io/flips-feature-flipping-for-java/"> <!-- KaTeX 0.8.3 --> <!-- if you have any issue check https://github.com/KaTeX/KaTeX --> <!-- Google Analytics --> <!-- End Google Analytics --> <!-- seo tags --> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Flips: Feature Flipping for Java | tech-lessons.in</title> <meta name="generator" content="Jekyll v3.8.5" /> <meta property="og:title" content="Flips: Feature Flipping for Java" /> <meta name="author" content="Sarthak Makhija" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Flips is an implementation of the Feature Toggles pattern for Java and Spring (Spring Core / Spring MVC/ Spring Boot) based application. Let’s understand what Flips is all about." /> <meta property="og:description" content="Flips is an implementation of the Feature Toggles pattern for Java and Spring (Spring Core / Spring MVC/ Spring Boot) based application. Let’s understand what Flips is all about." /> <link rel="canonical" href="https://sarthakmakhija.github.io/flips-feature-flipping-for-java/" /> <meta property="og:url" content="https://sarthakmakhija.github.io/flips-feature-flipping-for-java/" /> <meta property="og:site_name" content="tech-lessons.in" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2017-10-07T17:48:54+05:30" /> <script type="application/ld+json"> {"description":"Flips is an implementation of the Feature Toggles pattern for Java and Spring (Spring Core / Spring MVC/ Spring Boot) based application. Let’s understand what Flips is all about.","author":{"@type":"Person","name":"Sarthak Makhija"},"@type":"BlogPosting","url":"https://sarthakmakhija.github.io/flips-feature-flipping-for-java/","headline":"Flips: Feature Flipping for Java","dateModified":"2017-10-07T17:48:54+05:30","datePublished":"2017-10-07T17:48:54+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"https://sarthakmakhija.github.io/flips-feature-flipping-for-java/"},"@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <!-- Manual seo tags --> <!-- <title>Flips: Feature Flipping for Java | tech-lessons.in</title> <meta name="description" content="Flips is an implementation of the Feature Toggles pattern for Java and Spring (Spring Core / Spring MVC/ Spring Boot) based application. Let's understand wha..."> --> </head> <script defer=true src="/assets/js/main.min.js"></script> <body> <header class="site-header"> <!-- Toggle menu --> <nav class="clear"> <a aria-label="pull" id="pull" class="toggle" href="#"> <i class="fa fa-bars fa-lg"></i> </a> <!-- Menu --> <ul class="hide"> <li class="separator"> |</li> <li> <a class="clear" aria-label="Home" title="Home" href="/"> Home </a> </li> <li class="separator"> |</li> <li> <a class="clear" aria-label="About Me" title="About Me" href="/about/"> About Me </a> </li> <li class="separator"> |</li> <li> <a class="clear" aria-label="Search" title="Search" href="/search/"> <i class="fa fa-search" aria-hidden="true"></i> </a> </li> <li class="separator"> |</li> <li> <a class="clear" aria-label="Tags" title="Tags" href="/tags/"> <i class="fa fa-tags" aria-hidden="true"></i> </a> </li> </ul> </nav> </header> <div class="content"> <meta property="og:url" content="/flips-feature-flipping-for-java/" /> <meta property="og:type" content="article" /> <meta property="og:title" content="Flips: Feature Flipping for Java" /> <meta property="og:description" content="Flips is an implementation of the Feature Toggles pattern for Java and Spring (Spring Core / Spring MVC/ Spring Boot) based application. Let&#39;s understand what Flips is all about." /> <meta property="og:image" content="assets/img/pexels/flips-feature-image.jpg" /> <article class="feature-image"> <header id="main" style=""> <h1 id="Flips%3A+Feature+Flipping+for+Java" class="title">Flips: Feature Flipping for Java</h1> <div class="post-info"><a href="https://github.com/sarthakmakhija" target="_blank"> <img src="/assets/img/avatars/avatar.png"> <p class="meta"> Sarthak Makhija - October 7, 2017 </p></a></div> </header> <section class="post-content"> <p><a href="https://github.com/Feature-Flip/flips"><img class="alignright wp-image-53 size-medium" style="padding-left: 280px" title="Flips" src="/assets/img/pexels/flips.jpg" width="800" height="400" alt="Flips" /></a></p> <p id="182d" class="graf graf--p graf-after--figure"><a href="https://github.com/Feature-Flip/flips"><strong>Flips</strong></a> is an implementation of the Feature Toggles pattern for Java and Spring (Spring Core / Spring MVC/ Spring Boot) based application.</p> <p id="f611" class="graf graf--p graf-after--p"><strong><span style="text-decoration: underline;"><a href="https://martinfowler.com/articles/feature-toggles.html" target="_blank" rel="noopener nofollow">Feature Toggle</a> </span></strong>is a powerful technique that allows teams to modify system behavior and deliver new functionality to users rapidly but safely.</p> <h3 id="5714" class="graf graf--h3 graf-after--p">Why Another Library for Feature Toggles?</h3> <p id="5986" class="graf graf--p graf-after--h3">The idea behind <strong class="markup--strong markup--p-strong">Flips</strong> is to let the clients implement toggles with <em class="markup--em markup--p-em">minimum configuration and coding</em>.</p> <p id="6563" class="graf graf--p graf-after--p">The main motivations behind implementing this library were -</p> <ul class="postList"> <li id="0da3" class="graf graf--li graf-after--p">Should be simple to use</li> <li id="c57f" class="graf graf--li graf-after--li">Should require minimal configuration and code</li> <li id="a758" class="graf graf--li graf-after--li">Should be able to flip a feature based on various conditions</li> <li id="194c" class="graf graf--li graf-after--li">Should be able to flip a feature based on a combination of different conditions</li> <li id="24e2" class="graf graf--li graf-after--li">Should be possible for the clients to create custom conditions to suit their requirements</li> </ul> <p>Flips works with Java 8 and Spring Core/Spring MVC/Spring Boot, and is available for web and non-web applications.</p> <h3 id="b2ad" class="graf graf--h3 graf-after--p">What Does Flips Offer?</h3> <p>Flips provides various conditions to flip a feature. The image below summarizes the features:</p> <p><img class="size-medium wp-image-54 aligncenter" src="/assets/img/pexels/flips-features.png" alt="" /></p> <p>Any feature can be flipped ON or OFF based on different conditions which can be value of a property, current active profiles, days of the week, or a combination of these, etc.</p> <p id="4643" class="graf graf--p graf-after--blockquote">Let’s get started with in-depth understanding of these features.</p> <h3 id="b84c" class="graf graf--h3 graf-after--p">Getting Started</h3> <p id="8695" class="graf graf--p graf-after--h3">Include the necessary dependency:</p> <div class="highlighter-rouge"><pre class="lang:default decode:true ">&lt;dependency&gt;
   &lt;groupId&gt;com.github.feature-flip&lt;/groupId&gt;
   &lt;artifactId&gt;flips-web&lt;/artifactId&gt;
   &lt;version&gt;1.0.1&lt;/version&gt;
&lt;/dependency&gt;</pre></div> <p id="5f28" class="graf graf--p graf-after--pre">Or:</p> <div class="highlighter-rouge"><pre class="lang:default decode:true ">&lt;dependency&gt;
  &lt;groupId&gt;com.github.feature-flip&lt;/groupId&gt;
  &lt;artifactId&gt;flips-core&lt;/artifactId&gt;
  &lt;version&gt;1.0.1&lt;/version&gt;
&lt;/dependency&gt;</pre></div> <h3 id="5b8f" class="graf graf--h3 graf-after--pre">Detailed Description of All Annotations</h3> <p id="6fda" class="graf graf--p graf-after--h3">Flips provides various annotations to flip a feature. Let’s have a detailed walk-through of all the annotations:</p> <h3 id="8c53" class="graf graf--h3 graf-after--p">@FlipOnEnvironmentProperty</h3> <p id="81ce" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">@FlipOnEnvironmentProperty </strong>is used to flip a feature based on the value of an environment property.</p> <div class="highlighter-rouge"><pre class="graf graf--pre graf-after--p">@Component
class EmailSender {
    @FlipOnEnvironmentProperty(property = "feature.send.email", 
                               expectedValue = "true")
    public void sendEmail(EmailMessage emailMessage) {
    }
}
</pre></div> <h3 id="ebde" class="graf graf--h3 graf-after--p">@FlipOnProfiles</h3> <p id="d955" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">@FlipOnProfiles</strong> is used to flip a feature based on the environment in which the application is running</p> <div class="highlighter-rouge"><pre id="a052" class="graf graf--pre graf-after--p">@Component
class EmailSender {
    @FlipOnProfiles(activeProfiles = {"dev", "qa"})
    public void sendEmail(EmailMessage emailMessage) {
    }
}</pre></div> <p id="fccf" class="graf graf--p graf-after--pre">Feature sendEmail is enabled if the current profile (or environment) is either <strong>dev or qa.</strong></p> <h3 id="7e8a" class="graf graf--h3 graf-after--p">@FlipOnDaysOfWeek</h3> <p id="b04e" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">@FlipOnDaysOfWeek</strong> is used to flip a feature based on the day of the week.</p> <div class="highlighter-rouge"><pre id="7af4" class="graf graf--pre graf-after--p">@Component
class EmailSender {
    @FlipOnDaysOfWeek(daysOfWeek = {DayOfWeek.MONDAY})
    public void sendEmail(EmailMessage emailMessage) {
    }
}</pre></div> <p id="fbed" class="graf graf--p graf-after--pre">Feature sendEmail is enabled if the current day is <strong>MONDAY</strong>.</p> <h3 id="0827" class="graf graf--h3 graf-after--p">@FlipOnDateTime</h3> <p id="6a6d" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">@FlipOnDateTime</strong> is used to flip a feature based on date and time.</p> <div class="highlighter-rouge"><pre id="3f0e" class="graf graf--pre graf-after--p">@Component
class EmailSender {
    @FlipOnDateTime(cutoffDateTimeProperty = "default.date.enabled")
    public void sendEmail(EmailMessage emailMessage) {
    }
}</pre></div> <p>Feature sendEmail is enabled if the current datetime is equal to or greater than the value (in ISO-8601 format) defined by the <strong>default.date.enabled</strong> property.</p> <h3 id="f5bf" class="graf graf--h3 graf-after--p">@FlipOnSpringExpression</h3> <p id="a1d8" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">@FlipOnSpringExpression</strong> is used to flip a feature based on the evaluation of a Spring expression.</p> <div class="highlighter-rouge"><pre id="fc81" class="graf graf--pre graf-after--p">@Component
class EmailSender {
    @FlipOnSpringExpression(expression = "T(java.lang.Math).sqrt(4) * 100.0 
                                          &lt; T(java.lang.Math).sqrt(4) * 10.0")
    public void sendEmail(EmailMessage emailMessage) {
    }
}</pre></div> <p>Feature sendEmail is enabled if the expression evaluates to TRUE. This annotation happens to be one of the most powerful annotations in Flips library. Why so ?</p> <p class="graf graf--p graf-after--pre">One could always write a custom spring component and use the same in @FlipOnSpringExpression to flip a feature.</p> <h3 id="5d44" class="graf graf--h3 graf-after--blockquote">@FlipBean</h3> <p id="1200" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">@FlipBean</strong> is used to flip the invocation of a method with another method <em class="markup--em markup--p-em">defined in a different bean</em>.</p> <div class="highlighter-rouge"><pre id="aa3e" class="graf graf--pre graf-after--p">@Component
class EmailSender {
    @FlipBean(with = SendGridEmailSender.class)
    @FlipOnProfiles(activeProfiles = "DEV")
    public void sendEmail(EmailMessage emailMessage) {
    }
}</pre></div> <p>This will flip the invocation of the sendEmail method with a method (having same signature) defined in SendGridEmailSender Spring component if the current profile is <strong>DEV</strong>.</p> <h3 id="eab3" class="graf graf--h3 graf-after--p">@FlipOff</h3> <p id="42de" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">@FlipOff</strong> is used to flip a feature off.</p> <div class="highlighter-rouge"><pre class="graf graf--pre graf-after--p">@Component
class EmailSender {
    @FlipOff
    public void sendEmail(EmailMessage emailMessage) {
    }
}</pre></div> <p id="a3bb" class="graf graf--p graf-after--pre">Feature sendEmail is always DISABLED.</p> <h3 id="831b" class="graf graf--h3 graf-after--p">Combining annotations</h3> <div class="highlighter-rouge"><pre id="7b21" class="graf graf--pre graf-after--h3">@Component
class EmailSender {
    @FlipOnProfiles(activeProfiles = "dev")
    @FlipOnDaysOfWeek(daysOfWeek={DayOfWeek.MONDAY})
    public void sendEmail(EmailMessage emailMessage) {
    }
}</pre></div> <p id="7937" class="graf graf--p graf-after--pre">Feature sendEmail is enabled if the current profile is "<strong>dev</strong>" AND the current day of the week is <strong>MONDAY</strong>.</p> <h3 class="graf graf--p graf-after--pre">Import Flip Context Configuration</h3> <p id="65cb" class="graf graf--p graf-after--h3">In order to bring all Flips-related annotations into effect, you need to import FlipContextConfiguration or FlipWebContextConfiguration and you are ready to go.</p> <div class="highlighter-rouge"><pre class="lang:java decode:true ">@SpringBootApplication
@Import(FlipWebContextConfiguration.class)
class ApplicationConfig {
    public static void main(String[] args) {
        SpringApplication.run(ApplicationConfig.class, args);
    }
}</pre></div> <p id="1e18" class="graf graf--p graf-after--pre">Please refer to this <a class="markup--anchor markup--p-anchor" href="https://github.com/SarthakMakhija/flips-samples/blob/master/flips-sample-spring-boot/src/main/java/com/finder/article/ApplicationConfig.java" target="_blank" rel="nofollow noopener" data-href="https://github.com/SarthakMakhija/flips-samples/blob/master/flips-sample-spring-boot/src/main/java/com/finder/article/ApplicationConfig.java">sample project</a>.</p> <h3 id="6eed" class="graf graf--h3 graf-after--p">Creating Custom Annotations</h3> <p id="03ee" class="graf graf--p graf-after--h3">All the annotations provided by the library are of type <em class="markup--em markup--p-em">@FlipOnOff</em>, which is essentially a meta-annotation. So, create a custom annotation annotated with @FlipOnOff at the method level:</p> <div class="highlighter-rouge"><pre id="860e" class="graf graf--pre graf-after--p">@Target({ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME) 
@FlipOnOff(value = MyCustomCondition.class) !!Important
public @interface MyCustomAnnotation {
}</pre></div> <p>As a part of this annotation, specify the condition that will evaluate this annotation.</p> <div class="highlighter-rouge"><pre id="29c6" class="graf graf--pre graf-after--p">@Component
public class MyCustomCondition implements FlipCondition {
    @Override
    public boolean evaluateCondition(FeatureContext fContext,
                                     FlipAnnotationAttributes attr){
        
        <code style="color: darkorange">//Code to evaluate flip condition</code>
        return false;
    }
}
</pre></div> <p>This Condition class needs to implement <strong>FlipCondition</strong> and MUST be a Spring Component.</p> <p id="e279" class="graf graf--p graf-after--blockquote">That is it! You can use your custom annotation to any method to flip it ON or OFF based on your condition.</p> <h3 class="graf graf--pre graf-after--p">What Does It Mean “Feature Is DISABLED”?</h3> <p id="683b" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">FeatureNotEnabledException</strong> is thrown if a disabled feature is invoked. In case of a web application, one could use <a class="markup--anchor markup--p-anchor" href="https://mvnrepository.com/artifact/com.github.feature-flip/flips-web/1.0.1" target="_blank" rel="nofollow noopener" data-href="https://mvnrepository.com/artifact/com.github.feature-flip/flips-web/1.0.1">flips-web</a> dependency, which also provides a <em class="markup--em markup--p-em">ControllerAdvice</em> meant to handle this exception.</p> <p id="e8ac" class="graf graf--p graf-after--p">It returns a default response and a status code of 501, which can be overridden. Please refer to the <a class="markup--anchor markup--p-anchor" href="https://github.com/SarthakMakhija/flips-samples/tree/master/flips-sample-spring-boot/src/main/java/com/finder/article/advice" target="_blank" rel="nofollow noopener" data-href="https://github.com/SarthakMakhija/flips-samples/tree/master/flips-sample-spring-boot/src/main/java/com/finder/article/advice">sample project</a> for more information.</p> <h3 id="94a9" class="graf graf--h3 graf-after--p">Wrap Up</h3> <p id="9413" class="graf graf--p graf-after--h3">We believe the MVP is done and features like flipping at runtime and supporting database-driven feature flips are in the pipeline.</p> <p id="50de" class="graf graf--p graf-after--p">For any custom flip condition, one could go ahead and use @FlipOnSpringExpression with your custom spring bean to determine flip condition.</p> <p id="35ec" class="graf graf--p graf-after--p">If you want to have a look at the code or even want to contribute, you can check out <a class="markup--anchor markup--p-anchor" href="https://github.com/Feature-Flip/flips" target="_blank" rel="nofollow noopener" data-href="https://github.com/Feature-Flip/flips"><strong class="markup--strong markup--p-strong">Flips</strong></a>. Feel free to give any feedback.</p> </section> <!-- Social media shares --> <div class="share-buttons"> <ul class="share-buttons"> <div class="meta">Share</div> <li> <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fsarthakmakhija.github.io%2Fflips-feature-flipping-for-java%2F" target="_blank" title=" Facebook"> <i class="fa fa-facebook-square fa-2x" aria-hidden="true"></i> <span class="sr-only">Share on Facebook</span> </a> </li> <li> <a href="https://twitter.com/intent/tweet?text=Flips%3A+Feature+Flipping+for+Java%20https%3A%2F%2Fsarthakmakhija.github.io%2Fflips-feature-flipping-for-java%2F" target="_blank" title=""> <i class="fa fa-twitter-square fa-2x" aria-hidden="true"></i> <span class="sr-only">Tweet</span> </a> </li> <li> <a href="http://www.linkedin.com/shareArticle?mini=true&url=https://sarthakmakhija.github.io/flips-feature-flipping-for-java/&title=Flips%3A+Feature+Flipping+for+Java%20%7C%20tech-lessons.in&summary=&source=https://sarthakmakhija.github.io/flips-feature-flipping-for-java/" target="_blank" title=" LinkedIn"> <i class="fa fa-linkedin fa-2x" aria-hidden="true"></i> <span class="sr-only">Share on LinkedIn</span> </a> </li> </ul> </div> <!-- Tag list --> <footer> <div class="tag-list"> <div class="meta">Tags</div> <a class="button" href="/tags#Feature+Toggles"> <p><i class="fa fa-tag fa-fw"></i> Feature Toggles</p> </a> <a class="button" href="/tags#Flips"> <p><i class="fa fa-tag fa-fw"></i> Flips</p> </a> <a class="button" href="/tags#Spring+Boot"> <p><i class="fa fa-tag fa-fw"></i> Spring Boot</p> </a> <a class="button" href="/tags#Spring+MVC"> <p><i class="fa fa-tag fa-fw"></i> Spring MVC</p> </a> </div> </footer> </article> <!-- Disqus --> <div class="comments"> <div id="disqus_thread"></div> <script type="text/javascript"> var disqus_shortname = 'techlessons'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> <noscript>Please enable JavaScript to view comments.</noscript> </div> <!-- Post navigation --> <div id="post-nav"> <div id="previous-post"> <a alt="Let’s define Legacy Code" href="/lets-define-legacy-code/"> <p>Previous post</p> Let’s define Legacy Code </a> </div> </div> <!-- To change color of links in the page --> <style> header#main { background-repeat:no-repeat; background-image: url('/assets/img/pexels/flips-feature-image.jpg'); } </style> </div> <footer class="site-footer"> <p class="text"> tech-lessons.in © 2020. All Rights Reserved. Powered by <a href='https://jekyllrb.com/'>Jekyll</a> </p> <div class="footer-icons"> <ul> <li> <a href="https://github.com/sarthakmakhija" title="Follow on GitHub"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-github fa-stack-1x fa-inverse"></i> </span> </a> </li> <li> <a href="https://www.linkedin.com/in/sarthak-makhija-7a165a55/" title="Follow on LinkedIn"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i> </span> </a> </li> </ul> <ul> </ul> </div> </footer> </body> </html>
